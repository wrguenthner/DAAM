# DAAM
Damage and annealing models (DAAM) for apatite and zircon (U-Th)/He thermochronology. All scripts were created and tested in MATLAB R2017a.

The code takes in either apatite or zircon data and runs RDAAM (apatite, Flowers et al., 2009) or ZRDAAM (zircon, Guenthner et al., 2013). For damage annealing, the main code calls functions for annealing from Ginster et al., 2019, Guenthner et al., 2013 and Flowers et al., 2009. The scheme for inputing time-temperature (t-T) information for forward modeling uses a matrix (can be as large as the user wants) of two-column t-T paths separated by an empty column between each path.

DAAM_v[x].m is the main script, which calls functions Flowers2009.m, Ginster2019.m, or Guenthner2013.m for the various annealing models. HeDiff.m is the function that performs the finite element diffusion based upon damage matrices as determined by the annealing function. Other functions include tTInterpolate.m, which creates long t-T paths from the select t-T points used as inputs, and plotDateeU.m, which plots the data as model generated date-eU correlations. The other functions included here, virids.m and magma.m, are color matrices used for plotting (originally adapted from matplotlib).

To run, set-up two local matrices (i.e. in the same folder as the scripts), one for concentration and phase information, the other for t-T information. The concentration and phase matrix is a cell object with three columns, with each row representing an individual model grain (can be as many as the user desires). The first column consists of strings, either "zirc" for zircon models or "ap" for apatite models. The second column represents U concentration (in ppm) and the third column represents Th concentration (also in ppm). The tT matrix consists of two column t-T paths, each separated by a column of 0s. Time (in Ma) is in the first of the two columns and should increase from the present day (0 Ma) to the oldest t-T point. The second column consists of corresponding temperatures (in degrees Celsius). The user only needs to input inflection points in their modeled t-T path as tTInterpolate.m will fill in the intermediate steps of the t-T path. A series of prompts will guide the user to input these input matrices, and ask whether they are performing a grain size comparison model, or an annealing model comparison. Subsequent prompts ask for the annealing models to be used in output. Grain size is input either as a single value for all modeled grains (one date-eU curve as output), or as a mean with a 2-sigma standard deviation (three date-eU curves as output). NOTE: This input phase does NOT currently have error handling. Future improvements to the code will consist of a GUI for these input steps, error handling, and flexiblity in grain size input.

Output consists of date-eU curves and corresponding t-T paths in a single figure object with two panels. The date-eU model output can also be accessed in matrix form from the workspace as masterDateeU.
